function loadSetAdmin(){$gal.find(".card-set").each(function(a,b){$gal.packery("bindDraggabillyEvents",new Draggabilly(b,{handle:".move-handler"}))}),$gal.packery("on","dragItemPositioned",itemDragged),$("body").on("click",".foto-select-btn",function(a){a.preventDefault()}).on("click",".foto-select-btn li",function(){var a=$(this),b=a.attr("value"),c=a.parent(),d=c.parent().parent(),e=parseInt(a.attr("data-col")),f=parseInt(a.attr("data-row"));toggleLoading(d,!0,"size-change"),c.find(".current").removeClass("current"),a.addClass("current"),c.find(".selected").removeClass("selected");for(var g=1;f>=g;g++)for(var h=1;e>=h;h++)c.find("li").eq(h+cols*(g-1)-1).addClass("selected");var i=d.attr("data-type"),j=d.attr("data-order");switch(i){case"imagem":var k;$imgid=d.find("a").attr("data-img-id"),k="action=update_card_set_size&set_id="+pid+"&order="+j+"&img_id="+$imgid+"&type="+i+"&size="+b,$.get(ajax_request_url,k,function(a){null!=a.url&&(d.find(".item-container").css("background-image","url("+a.url+")"),d.removeClass(d.attr("data-size")).addClass(b).attr("data-size",b),toggleLoading(d,!1,"size-change"),$gal.packery("layout"))},"json");break;case"texto":case"video":case"void":var k="action=update_card_set_size&set_id="+pid+"&order="+j+"&type="+i+"&size="+b;$.get(ajax_request_url,k,function(a){d.removeClass(d.attr("data-size")).addClass(b).attr("data-size",b),$gal.packery("layout"),toggleLoading(d,!1,"size-change"),textResize()},"json")}}),$(".foto-select-btn li").hover(function(){var a=$(this),b=a.parent(),c=parseInt(a.attr("data-col")),d=parseInt(a.attr("data-row"));b.find(".hover").removeClass("hover");for(var e=1;d>=e;e++)for(var f=1;c>=f;f++)b.find("li").eq(f+cols*(e-1)-1).addClass("hover")}).parent().mouseout(function(){$(this).find("li").removeClass("hover")})}function itemDragged(a){var b=($(a.element),[]),c=[],d=0;if($gal.packery("getItemElements").forEach(function(a){var e=parseInt($(a).attr("data-order"));e!=d&&(b.push(e),c.push(d)),$(a).attr("data-order",d++)}),0==b.length||0==c.length||b.length!=c.length)return void setTimeout(function(){$gal.packery("layout")},100);console.log(b.toString()),console.log(c.toString());var e="action=update_set_order&pid="+pid+"&old_list="+b.toString()+"&new_list="+c.toString();toggleLoading($("body"),!0,"dragged",!0),$.get(ajax_request_url,e,function(a){setTimeout(function(){toggleLoading($("body"),!1,"dragged"),$gal.packery("layout")},100)})}var $gal=$(".mosaic"),$sizer=$(".mosaic-sizer"),cols=6,rows=3;!function(a){function b(){}function c(a){function c(b){b.prototype.option||(b.prototype.option=function(b){a.isPlainObject(b)&&(this.options=a.extend(!0,this.options,b))})}function e(b,c){a.fn[b]=function(e){if("string"==typeof e){for(var g=d.call(arguments,1),h=0,i=this.length;i>h;h++){var j=this[h],k=a.data(j,b);if(k)if(a.isFunction(k[e])&&"_"!==e.charAt(0)){var l=k[e].apply(k,g);if(void 0!==l)return l}else f("no such method '"+e+"' for "+b+" instance");else f("cannot call methods on "+b+" prior to initialization; attempted to call '"+e+"'")}return this}return this.each(function(){var d=a.data(this,b);d?(d.option(e),d._init()):(d=new c(this,e),a.data(this,b,d))})}}if(a){var f="undefined"==typeof console?b:function(a){console.error(a)};return a.bridget=function(a,b){c(b),e(a,b)},a.bridget}}var d=Array.prototype.slice;"function"==typeof define&&define.amd?define("jquery-bridget/jquery.bridget",["jquery"],c):c("object"==typeof exports?require("jquery"):a.jQuery)}(window),function(a){function b(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function c(a,b){var c=d(a,b)?f:e;c(a,b)}var d,e,f;"classList"in document.documentElement?(d=function(a,b){return a.classList.contains(b)},e=function(a,b){a.classList.add(b)},f=function(a,b){a.classList.remove(b)}):(d=function(a,c){return b(c).test(a.className)},e=function(a,b){d(a,b)||(a.className=a.className+" "+b)},f=function(a,c){a.className=a.className.replace(b(c)," ")});var g={hasClass:d,addClass:e,removeClass:f,toggleClass:c,has:d,add:e,remove:f,toggle:c};"function"==typeof define&&define.amd?define("classie/classie",g):"object"==typeof exports?module.exports=g:a.classie=g}(window),function(a){function b(a){if(a){if("string"==typeof d[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var b,e=0,f=c.length;f>e;e++)if(b=c[e]+a,"string"==typeof d[b])return b}}var c="Webkit Moz ms Ms O".split(" "),d=document.documentElement.style;"function"==typeof define&&define.amd?define("get-style-property/get-style-property",[],function(){return b}):"object"==typeof exports?module.exports=b:a.getStyleProperty=b}(window),function(a,b){function c(a){var b=parseFloat(a),c=-1===a.indexOf("%")&&!isNaN(b);return c&&b}function d(){}function e(){for(var a={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},b=0,c=h.length;c>b;b++){var d=h[b];a[d]=0}return a}function f(b){function d(){if(!m){m=!0;var d=a.getComputedStyle;if(j=function(){var a=d?function(a){return d(a,null)}:function(a){return a.currentStyle};return function(b){var c=a(b);return c||g("Style returned "+c+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),c}}(),k=b("boxSizing")){var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style[k]="border-box";var f=document.body||document.documentElement;f.appendChild(e);var h=j(e);l=200===c(h.width),f.removeChild(e)}}}function f(a){if(d(),"string"==typeof a&&(a=document.querySelector(a)),a&&"object"==typeof a&&a.nodeType){var b=j(a);if("none"===b.display)return e();var f={};f.width=a.offsetWidth,f.height=a.offsetHeight;for(var g=f.isBorderBox=!(!k||!b[k]||"border-box"!==b[k]),m=0,n=h.length;n>m;m++){var o=h[m],p=b[o];p=i(a,p);var q=parseFloat(p);f[o]=isNaN(q)?0:q}var r=f.paddingLeft+f.paddingRight,s=f.paddingTop+f.paddingBottom,t=f.marginLeft+f.marginRight,u=f.marginTop+f.marginBottom,v=f.borderLeftWidth+f.borderRightWidth,w=f.borderTopWidth+f.borderBottomWidth,x=g&&l,y=c(b.width);y!==!1&&(f.width=y+(x?0:r+v));var z=c(b.height);return z!==!1&&(f.height=z+(x?0:s+w)),f.innerWidth=f.width-(r+v),f.innerHeight=f.height-(s+w),f.outerWidth=f.width+t,f.outerHeight=f.height+u,f}}function i(b,c){if(a.getComputedStyle||-1===c.indexOf("%"))return c;var d=b.style,e=d.left,f=b.runtimeStyle,g=f&&f.left;return g&&(f.left=b.currentStyle.left),d.left=c,c=d.pixelLeft,d.left=e,g&&(f.left=g),c}var j,k,l,m=!1;return f}var g="undefined"==typeof console?d:function(a){console.error(a)},h=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];"function"==typeof define&&define.amd?define("get-size/get-size",["get-style-property/get-style-property"],f):"object"==typeof exports?module.exports=f(require("desandro-get-style-property")):a.getSize=f(a.getStyleProperty)}(window),function(a){function b(b){var c=a.event;return c.target=c.target||c.srcElement||b,c}var c=document.documentElement,d=function(){};c.addEventListener?d=function(a,b,c){a.addEventListener(b,c,!1)}:c.attachEvent&&(d=function(a,c,d){a[c+d]=d.handleEvent?function(){var c=b(a);d.handleEvent.call(d,c)}:function(){var c=b(a);d.call(a,c)},a.attachEvent("on"+c,a[c+d])});var e=function(){};c.removeEventListener?e=function(a,b,c){a.removeEventListener(b,c,!1)}:c.detachEvent&&(e=function(a,b,c){a.detachEvent("on"+b,a[b+c]);try{delete a[b+c]}catch(d){a[b+c]=void 0}});var f={bind:d,unbind:e};"function"==typeof define&&define.amd?define("eventie/eventie",f):"object"==typeof exports?module.exports=f:a.eventie=f}(window),function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:e.EventEmitter=a}.call(this),function(a,b){"function"==typeof define&&define.amd?define("unipointer/unipointer",["eventEmitter/EventEmitter","eventie/eventie"],function(c,d){return b(a,c,d)}):"object"==typeof exports?module.exports=b(a,require("wolfy87-eventemitter"),require("eventie")):a.Unipointer=b(a,a.EventEmitter,a.eventie)}(window,function(a,b,c){function d(){}function e(){}e.prototype=new b,e.prototype.bindStartEvent=function(a){this._bindStartEvent(a,!0)},e.prototype.unbindStartEvent=function(a){this._bindStartEvent(a,!1)},e.prototype._bindStartEvent=function(b,d){d=void 0===d?!0:!!d;var e=d?"bind":"unbind";a.navigator.pointerEnabled?c[e](b,"pointerdown",this):a.navigator.msPointerEnabled?c[e](b,"MSPointerDown",this):(c[e](b,"mousedown",this),c[e](b,"touchstart",this))},e.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},e.prototype.getTouch=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];if(d.identifier==this.pointerIdentifier)return d}},e.prototype.onmousedown=function(a){var b=a.button;b&&0!==b&&1!==b||this._pointerDown(a,a)},e.prototype.ontouchstart=function(a){this._pointerDown(a,a.changedTouches[0])},e.prototype.onMSPointerDown=e.prototype.onpointerdown=function(a){this._pointerDown(a,a)},e.prototype._pointerDown=function(a,b){this.isPointerDown||(this.isPointerDown=!0,this.pointerIdentifier=void 0!==b.pointerId?b.pointerId:b.identifier,this.pointerDown(a,b))},e.prototype.pointerDown=function(a,b){this._bindPostStartEvents(a),this.emitEvent("pointerDown",[a,b])};var f={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"],MSPointerDown:["MSPointerMove","MSPointerUp","MSPointerCancel"]};return e.prototype._bindPostStartEvents=function(b){if(b){for(var d=f[b.type],e=b.preventDefault?a:document,g=0,h=d.length;h>g;g++){var i=d[g];c.bind(e,i,this)}this._boundPointerEvents={events:d,node:e}}},e.prototype._unbindPostStartEvents=function(){var a=this._boundPointerEvents;if(a&&a.events){for(var b=0,d=a.events.length;d>b;b++){var e=a.events[b];c.unbind(a.node,e,this)}delete this._boundPointerEvents}},e.prototype.onmousemove=function(a){this._pointerMove(a,a)},e.prototype.onMSPointerMove=e.prototype.onpointermove=function(a){a.pointerId==this.pointerIdentifier&&this._pointerMove(a,a)},e.prototype.ontouchmove=function(a){var b=this.getTouch(a.changedTouches);b&&this._pointerMove(a,b)},e.prototype._pointerMove=function(a,b){this.pointerMove(a,b)},e.prototype.pointerMove=function(a,b){this.emitEvent("pointerMove",[a,b])},e.prototype.onmouseup=function(a){this._pointerUp(a,a)},e.prototype.onMSPointerUp=e.prototype.onpointerup=function(a){a.pointerId==this.pointerIdentifier&&this._pointerUp(a,a)},e.prototype.ontouchend=function(a){var b=this.getTouch(a.changedTouches);b&&this._pointerUp(a,b)},e.prototype._pointerUp=function(a,b){this._pointerDone(),this.pointerUp(a,b)},e.prototype.pointerUp=function(a,b){this.emitEvent("pointerUp",[a,b])},e.prototype._pointerDone=function(){this.isPointerDown=!1,delete this.pointerIdentifier,this._unbindPostStartEvents(),this.pointerDone()},e.prototype.pointerDone=d,e.prototype.onMSPointerCancel=e.prototype.onpointercancel=function(a){a.pointerId==this.pointerIdentifier&&this._pointerCancel(a,a)},e.prototype.ontouchcancel=function(a){var b=this.getTouch(a.changedTouches);b&&this._pointerCancel(a,b)},e.prototype._pointerCancel=function(a,b){this._pointerDone(),this.pointerCancel(a,b)},e.prototype.pointerCancel=function(a,b){this.emitEvent("pointerCancel",[a,b])},e.getPointerPoint=function(a){return{x:void 0!==a.pageX?a.pageX:a.clientX,y:void 0!==a.pageY?a.pageY:a.clientY}},e}),function(a,b){"function"==typeof define&&define.amd?define("unidragger/unidragger",["eventie/eventie","unipointer/unipointer"],function(c,d){return b(a,c,d)}):"object"==typeof exports?module.exports=b(a,require("eventie"),require("unipointer")):a.Unidragger=b(a,a.eventie,a.Unipointer)}(window,function(a,b,c){function d(){}function e(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function f(a){for(;a!=document.body;)if(a=a.parentNode,"A"==a.nodeName)return a}function g(){}function h(){return!1}g.prototype=new c,g.prototype.bindHandles=function(){this._bindHandles(!0)},g.prototype.unbindHandles=function(){this._bindHandles(!1)};var i=a.navigator;g.prototype._bindHandles=function(a){a=void 0===a?!0:!!a;var c;c=i.pointerEnabled?function(b){b.style.touchAction=a?"none":""}:i.msPointerEnabled?function(b){b.style.msTouchAction=a?"none":""}:function(){a&&k(g)};for(var d=a?"bind":"unbind",e=0,f=this.handles.length;f>e;e++){var g=this.handles[e];this._bindStartEvent(g,a),c(g),b[d](g,"click",this)}};var j="attachEvent"in document.documentElement,k=j?function(a){"IMG"==a.nodeName&&(a.ondragstart=h);for(var b=a.querySelectorAll("img"),c=0,d=b.length;d>c;c++){var e=b[c];e.ondragstart=h}}:d,l=g.allowTouchstartNodes={INPUT:!0,A:!0,BUTTON:!0,SELECT:!0};return g.prototype.pointerDown=function(a,b){this._dragPointerDown(a,b);var c=document.activeElement;c&&c.blur&&c.blur(),this._bindPostStartEvents(a),this.emitEvent("pointerDown",[a,b])},g.prototype._dragPointerDown=function(a,b){this.pointerDownPoint=c.getPointerPoint(b);var d=a.target.nodeName,g="touchstart"==a.type&&(l[d]||f(a.target));g||"SELECT"==d||e(a)},g.prototype.pointerMove=function(a,b){var c=this._dragPointerMove(a,b);this.emitEvent("pointerMove",[a,b,c]),this._dragMove(a,b,c)},g.prototype._dragPointerMove=function(a,b){var d=c.getPointerPoint(b),e={x:d.x-this.pointerDownPoint.x,y:d.y-this.pointerDownPoint.y};return!this.isDragging&&this.hasDragStarted(e)&&this._dragStart(a,b),e},g.prototype.hasDragStarted=function(a){return Math.abs(a.x)>3||Math.abs(a.y)>3},g.prototype.pointerUp=function(a,b){this.emitEvent("pointerUp",[a,b]),this._dragPointerUp(a,b)},g.prototype._dragPointerUp=function(a,b){this.isDragging?this._dragEnd(a,b):this._staticClick(a,b)},g.prototype._dragStart=function(a,b){this.isDragging=!0,this.dragStartPoint=g.getPointerPoint(b),this.isPreventingClicks=!0,this.dragStart(a,b)},g.prototype.dragStart=function(a,b){this.emitEvent("dragStart",[a,b])},g.prototype._dragMove=function(a,b,c){this.isDragging&&this.dragMove(a,b,c)},g.prototype.dragMove=function(a,b,c){this.emitEvent("dragMove",[a,b,c])},g.prototype._dragEnd=function(a,b){this.isDragging=!1;var c=this;setTimeout(function(){delete c.isPreventingClicks}),this.dragEnd(a,b)},g.prototype.dragEnd=function(a,b){this.emitEvent("dragEnd",[a,b])},g.prototype.onclick=function(a){this.isPreventingClicks&&e(a)},g.prototype._staticClick=function(a,b){"INPUT"==a.target.nodeName&&"text"==a.target.type&&a.target.focus(),this.staticClick(a,b)},g.prototype.staticClick=function(a,b){this.emitEvent("staticClick",[a,b])},g.getPointerPoint=function(a){return{x:void 0!==a.pageX?a.pageX:a.clientX,y:void 0!==a.pageY?a.pageY:a.clientY}},g.getPointerPoint=c.getPointerPoint,g}),function(a,b){"function"==typeof define&&define.amd?define("draggabilly/draggabilly",["classie/classie","get-style-property/get-style-property","get-size/get-size","unidragger/unidragger"],function(c,d,e,f){return b(a,c,d,e,f)}):"object"==typeof exports?module.exports=b(a,require("desandro-classie"),require("desandro-get-style-property"),require("get-size"),require("unidragger")):a.Draggabilly=b(a,a.classie,a.getStyleProperty,a.getSize,a.Unidragger)}(window,function(a,b,c,d,e){function f(){}function g(a,b){for(var c in b)a[c]=b[c];return a}function h(a,b){this.element="string"==typeof a?k.querySelector(a):a,v&&(this.$element=v(this.element)),this.options=g({},this.constructor.defaults),this.option(b),this._create()}function i(a,b,c){return c=c||"round",b?Math[c](a/b)*b:a}for(var j,k=a.document,l=k.defaultView,m=l&&l.getComputedStyle?function(a){return l.getComputedStyle(a,null)}:function(a){return a.currentStyle},n="object"==typeof HTMLElement?function(a){return a instanceof HTMLElement}:function(a){return a&&"object"==typeof a&&1==a.nodeType&&"string"==typeof a.nodeName},o=0,p="webkit moz ms o".split(" "),q=a.requestAnimationFrame,r=a.cancelAnimationFrame,s=0;s<p.length&&(!q||!r);s++)j=p[s],q=q||a[j+"RequestAnimationFrame"],r=r||a[j+"CancelAnimationFrame"]||a[j+"CancelRequestAnimationFrame"];q&&r||(q=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-o)),e=a.setTimeout(function(){b(c+d)},d);return o=c+d,e},r=function(b){a.clearTimeout(b)});var t=c("transform"),u=!!c("perspective"),v=a.jQuery;g(h.prototype,e.prototype),h.defaults={},h.prototype.option=function(a){g(this.options,a)},h.prototype._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=g({},this.position);var a=m(this.element);"relative"!=a.position&&"absolute"!=a.position&&(this.element.style.position="relative"),this.enable(),this.setHandles()},h.prototype.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles()},h.prototype.dispatchEvent=function(b,c,d){var e=[c].concat(d);this.emitEvent(b,e);var f=a.jQuery;if(f&&this.$element)if(c){var g=f.Event(c);g.type=b,this.$element.trigger(g,d)}else this.$element.trigger(b,d)},h.prototype._getPosition=function(){var a=m(this.element),b=parseInt(a.left,10),c=parseInt(a.top,10);this.position.x=isNaN(b)?0:b,this.position.y=isNaN(c)?0:c,this._addTransformPosition(a)},h.prototype._addTransformPosition=function(a){if(t){var b=a[t];if(0===b.indexOf("matrix")){var c=b.split(","),d=0===b.indexOf("matrix3d")?12:4,e=parseInt(c[d],10),f=parseInt(c[d+1],10);this.position.x+=e,this.position.y+=f}}},h.prototype.pointerDown=function(a,c){this._dragPointerDown(a,c);var d=k.activeElement;d&&d.blur&&d.blur(),this._bindPostStartEvents(a),b.add(this.element,"is-pointer-down"),this.dispatchEvent("pointerDown",a,[c])},h.prototype.pointerMove=function(a,b){var c=this._dragPointerMove(a,b);this.dispatchEvent("pointerMove",a,[b,c]),this._dragMove(a,b,c)},h.prototype.dragStart=function(a,c){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.isDragging=!0,b.add(this.element,"is-dragging"),this.dispatchEvent("dragStart",a,[c]),this.animate())},h.prototype.measureContainment=function(){var a=this.options.containment;if(a){this.size=d(this.element);var b=this.element.getBoundingClientRect(),c=n(a)?a:"string"==typeof a?k.querySelector(a):this.element.parentNode;this.containerSize=d(c);var e=c.getBoundingClientRect();this.relativeStartPosition={x:b.left-e.left,y:b.top-e.top}}},h.prototype.dragMove=function(a,b,c){if(this.isEnabled){var d=c.x,e=c.y,f=this.options.grid,g=f&&f[0],h=f&&f[1];d=i(d,g),e=i(e,h),d=this.containDrag("x",d,g),e=this.containDrag("y",e,h),d="y"==this.options.axis?0:d,e="x"==this.options.axis?0:e,this.position.x=this.startPosition.x+d,this.position.y=this.startPosition.y+e,this.dragPoint.x=d,this.dragPoint.y=e,this.dispatchEvent("dragMove",a,[b,c])}},h.prototype.containDrag=function(a,b,c){if(!this.options.containment)return b;var d="x"==a?"width":"height",e=this.relativeStartPosition[a],f=i(-e,c,"ceil"),g=this.containerSize[d]-e-this.size[d];return g=i(g,c,"floor"),Math.min(g,Math.max(f,b))},h.prototype.pointerUp=function(a,c){b.remove(this.element,"is-pointer-down"),this.dispatchEvent("pointerUp",a,[c]),this._dragPointerUp(a,c)},h.prototype.dragEnd=function(a,c){this.isEnabled&&(this.isDragging=!1,t&&(this.element.style[t]="",this.setLeftTop()),b.remove(this.element,"is-dragging"),this.dispatchEvent("dragEnd",a,[c]))},h.prototype.animate=function(){if(this.isDragging){this.positionDrag();var a=this;q(function(){a.animate()})}};var w=u?function(a,b){return"translate3d( "+a+"px, "+b+"px, 0)"}:function(a,b){return"translate( "+a+"px, "+b+"px)"};return h.prototype.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},h.prototype.positionDrag=t?function(){this.element.style[t]=w(this.dragPoint.x,this.dragPoint.y)}:h.prototype.setLeftTop,h.prototype.staticClick=function(a,b){this.dispatchEvent("staticClick",a,[b])},h.prototype.enable=function(){this.isEnabled=!0},h.prototype.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},h.prototype.destroy=function(){this.disable(),t&&(this.element.style[t]=""),this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.$element&&this.$element.removeData("draggabilly")},h.prototype._init=f,v&&v.bridget&&v.bridget("draggabilly",h),h});